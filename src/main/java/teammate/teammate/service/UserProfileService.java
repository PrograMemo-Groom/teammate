package teammate.teammate.service;import jakarta.persistence.EntityNotFoundException;import lombok.RequiredArgsConstructor;import org.springframework.stereotype.Service;import org.springframework.web.multipart.MultipartFile;import teammate.teammate.domain.UserProfile;import teammate.teammate.domain.Users;import teammate.teammate.repository.UserProfileRepository;import java.io.IOException;import java.nio.file.Files;import java.nio.file.Path;import java.nio.file.StandardCopyOption;@Service@RequiredArgsConstructorpublic class UserProfileService {	private static final String UPLOAD_DIR = "uploads/";	private final UserProfileRepository userProfileRepository;	//프로필 조회	public UserProfile getUserProfile(String userId){		return userProfileRepository.findById(userId)				.orElseThrow(() -> new EntityNotFoundException("사용자 프로필을 찾을 수 없습니다. userId: " + userId));	}	//프로필 수정	public UserProfile updateUserProfile(String userId, UserProfile updatedProfile){		UserProfile profile = getUserProfile(userId);		Users user = profile.getUser();		user.setNickname(updatedProfile.getUser().getNickname());		user.setIntroduction(updatedProfile.getUser().getIntroduction());		user.setPreferredPosition(updatedProfile.getUser().getPreferredPosition());		user.setStatusMessage(updatedProfile.getUser().getStatusMessage());		return userProfileRepository.save(profile);	}	//상태 메시지 조회	public String getStatusMessage(String userId){		return userProfileRepository.findById(userId)				.map(UserProfile::getStatusMessage)				.orElse("상태 메시지가 없습니다.");	}	//이미지 업로드	public String uploadProfileImage(String userId, MultipartFile file) throws IOException {		UserProfile profile = userProfileRepository.findById(userId)				.orElseThrow(() -> new EntityNotFoundException("사용자 프로필을 찾을 수 없습니다. userId: "+userId));		//파일 저장 경로 설정		String fileName = userId + "_" + file.getOriginalFilename();		Path filePath = Path.of(UPLOAD_DIR + fileName);		Files.copy(file.getInputStream(), filePath, StandardCopyOption.REPLACE_EXISTING);		//데이터베이스에 이미지 경로 저장		profile.setProfileImg(fileName);		userProfileRepository.save(profile);		return "uploads/" + fileName;	}}